<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Space Shooter</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    body {
      margin: 0;
      background: #020617;
      color: #e5e7eb;
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    .game-container {
      display: flex;
      gap: 1.5rem;
    }

    canvas {
      background: #020617;
      border: 2px solid #38bdf8;
    }

    .ui {
      width: 220px;
      background: #0f172a;
      padding: 1rem;
      border-radius: 8px;
    }

    .key {
      padding: 0.4rem 0.6rem;
      border-radius: 4px;
      background: #111827;
      margin-bottom: 0.4rem;
      font-size: 0.9rem;
    }

    .key.active {
      background: #38bdf8;
      color: #020617;
      font-weight: bold;
    }

    .stat {
      margin-top: 0.6rem;
      font-weight: bold;
    }

    button {
      margin-top: 1rem;
      width: 100%;
      padding: 0.5rem;
      background: #38bdf8;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
    }
  </style>
</head>
<body>

<div class="game-container">
  <canvas id="game" width="500" height="400"></canvas>

  <div class="ui">
    <h3>Controls</h3>
    <div id="left" class="key">← Move Left</div>
    <div id="right" class="key">→ Move Right</div>
    <div id="space" class="key">Space Shoot</div>

    <div class="stat">Score: <span id="score">0</span></div>
    <div class="stat">High Score: <span id="highScore">0</span></div>
    <div class="stat">Health: <span id="health">3</span></div>

    <button onclick="restartGame()">Restart</button>
  </div>
</div>

<script>
  const canvas = document.getElementById("game");
  const ctx = canvas.getContext("2d");

  const scoreEl = document.getElementById("score");
  const highScoreEl = document.getElementById("highScore");
  const healthEl = document.getElementById("health");

  let highScore = localStorage.getItem("highScore") || 0;
  highScoreEl.textContent = highScore;

  const keys = {};
  let ship, bullets, aliens;
  let score, health, gameOver;
  let spawnRate, lastSpawn;

  function init() {
    ship = { x: 230, y: 360, width: 40, height: 20, speed: 5 };
    bullets = [];
    aliens = [];

    score = 0;
    health = 3;
    gameOver = false;

    spawnRate = 2000; // start slow
    lastSpawn = 0;

    scoreEl.textContent = score;
    healthEl.textContent = health;
  }

  function restartGame() {
    init();
  }

  window.addEventListener("keydown", e => {
    keys[e.code] = true;
    toggleKey(e.code, true);
  });

  window.addEventListener("keyup", e => {
    keys[e.code] = false;
    toggleKey(e.code, false);
  });

  function toggleKey(code, active) {
    if (code === "ArrowLeft") toggle("left", active);
    if (code === "ArrowRight") toggle("right", active);
    if (code === "Space") toggle("space", active);
  }

  function toggle(id, active) {
    document.getElementById(id).classList.toggle("active", active);
  }

  function shoot() {
    bullets.push({
      x: ship.x + ship.width / 2 - 2,
      y: ship.y,
      width: 4,
      height: 10,
      speed: 8
    });
  }

  function spawnAlien() {
    aliens.push({
      x: Math.random() * (canvas.width - 30),
      y: -20,
      width: 30,
      height: 20,
      speed: 1 + Math.random()
    });

    if (spawnRate > 600) spawnRate -= 50; // increase difficulty
  }

  function update(time) {
    if (gameOver) return;

    if (keys["ArrowLeft"] && ship.x > 0) ship.x -= ship.speed;
    if (keys["ArrowRight"] && ship.x + ship.width < canvas.width)
      ship.x += ship.speed;

    if (keys["Space"]) {
      keys["Space"] = false;
      shoot();
    }

    bullets.forEach(b => b.y -= b.speed);
    bullets = bullets.filter(b => b.y > -20);

    if (time - lastSpawn > spawnRate) {
      spawnAlien();
      lastSpawn = time;
    }

    aliens.forEach(a => a.y += a.speed);

    aliens.forEach(alien => {
      bullets.forEach(bullet => {
        if (
          bullet.x < alien.x + alien.width &&
          bullet.x + bullet.width > alien.x &&
          bullet.y < alien.y + alien.height &&
          bullet.y + bullet.height > alien.y
        ) {
          alien.hit = true;
          bullet.y = -30;
          score++;
          scoreEl.textContent = score;

          if (score > highScore) {
            highScore = score;
            highScoreEl.textContent = highScore;
            localStorage.setItem("highScore", highScore);
          }
        }
      });

      if (alien.y + alien.height >= ship.y) {
        alien.hit = true;
        health--;
        healthEl.textContent = health;
        if (health <= 0) gameOver = true;
      }
    });

    aliens = aliens.filter(a => !a.hit);
  }

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    ctx.fillStyle = "#38bdf8";
    ctx.fillRect(ship.x, ship.y, ship.width, ship.height);

    ctx.fillStyle = "#e5e7eb";
    bullets.forEach(b =>
      ctx.fillRect(b.x, b.y, b.width, b.height)
    );

    ctx.fillStyle = "#22c55e";
    aliens.forEach(a =>
      ctx.fillRect(a.x, a.y, a.width, a.height)
    );

    if (gameOver) {
      ctx.fillStyle = "#e5e7eb";
      ctx.font = "28px Arial";
      ctx.textAlign = "center";
      ctx.fillText("GAME OVER", canvas.width / 2, canvas.height / 2);
    }
  }

  function loop(time) {
    update(time);
    draw();
    requestAnimationFrame(loop);
  }

  init();
  loop();
</script>

</body>
</html>
